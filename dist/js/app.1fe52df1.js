(function(){"use strict";var e={7596:function(e,t,i){var n=i(5319),r=i.n(n),o=i(4355),s=i.n(o),a=i(5596),l=i.n(a),c=i(8339),u=i.n(c),h=i(874),d=i.n(h),m=i(2916),v=i.n(m),f=i(9507),g=i.n(f),w=i(4932),p=i.n(w),S=i(7203),C=i.n(S),y=i(6848),x=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("container")],1)},b=[],_=function(){var e=this,t=e._self._c;return t("el-container",[t("el-header",[t("headerContainer")],1),t("el-container",[t("el-aside",{attrs:{width:"250px"}},[t("asideContainer")],1),t("el-main",[t("mainContainer")],1)],1)],1)},T=[],k=function(){var e=this,t=e._self._c;return t("header",{staticClass:"header"},[t("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleSelect}},[t("el-menu-item",{attrs:{index:"1"}},[t("i",{staticClass:"el-icon-edit large-icon"}),e._v(" 处理中心 ")]),t("el-submenu",{attrs:{index:"2"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-s-operation large-icon"}),e._v("影像选择")]),t("el-menu-item",{attrs:{index:"2-1"},on:{click:function(t){return e.changeBaseMap(e.imageSourceArry.tdt)}}},[e._v("天地图")]),t("el-menu-item",{attrs:{index:"2-2"},on:{click:function(t){return e.changeBaseMap(e.imageSourceArry.esri)}}},[e._v("Arcgis底图")]),t("el-menu-item",{attrs:{index:"2-3"},on:{click:function(t){return e.changeBaseMap(e.imageSourceArry.osm)}}},[e._v("OSM底图（加载慢）")]),t("el-menu-item",{attrs:{index:"2-4"},on:{click:function(t){return e.changeBaseMap(e.imageSourceArry.stadiaLayer)}}},[e._v("简化视觉底图")])],2),t("el-submenu",{attrs:{index:"3"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-menu large-icon"}),e._v("基础功能")]),t("el-menu-item",{attrs:{index:"3-1"}},[e._v("切换地形 "),t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.toggleTerrain},model:{value:e.is3Dtrue,callback:function(t){e.is3Dtrue=t},expression:"is3Dtrue"}})],1),t("el-menu-item",{attrs:{index:"3-2"}},[e._v("天气特效 "),t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.toggleWeather},model:{value:e.isWeatherTrue,callback:function(t){e.isWeatherTrue=t},expression:"isWeatherTrue"}})],1)],2),t("el-menu-item",{attrs:{index:"4"}},[t("a",{attrs:{href:"https://dlkx.hunnu.edu.cn/",target:"_blank"}},[t("i",{staticClass:"el-icon-phone large-icon"}),e._v("联系我们")])])],1)],1)},M=[];const z=new y["default"];var P=z,A={data(){return{is3Dtrue:!1,isWeatherTrue:!0,activeIndex:"1",imageSourceArry:{tdt:new Cesium.UrlTemplateImageryProvider({url:"http://{s}.tianditu.com/DataServer?T=img_w&X={x}&Y={y}&L={z}&tk=2501982e131a281d49765ab584c34c24",subdomains:["t0","t1","t2","t3","t4","t5","t6","t7"],maximumLevel:18,minimumLevel:1,credit:"Tianditu"}),esri:new Cesium.WebMapTileServiceImageryProvider({url:"https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/WMTS",layer:"World_Imagery",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible",maximumLevel:19,credit:new Cesium.Credit("© Esri","https://www.esri.com/")}),osm:new Cesium.OpenStreetMapImageryProvider({url:"https://a.tile.openstreetmap.org/"}),stadiaLayer:new Cesium.UrlTemplateImageryProvider({url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}.png",credit:"© Stadia Maps, © OpenMapTiles, © OpenStreetMap contributors"})}}},methods:{handleSelect(e,t){console.log(e,t)},changeBaseMap(e){P.$emit("changeBaseMap",e)},toggleTerrain(e){P.$emit("toggle-terrain",e)},toggleWeather(e){P.$emit("toggle-weather",e)}}},O=A,D=i(1656),I=(0,D.A)(O,k,M,!1,null,"ef822166",null),W=I.exports,L=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",height:"100%"},attrs:{id:"cesiumContainer"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.weatherTool,expression:"weatherTool"}],staticClass:"weather-tools"},[t("el-select",{attrs:{placeholder:"请选择天气"},on:{change:e.weatherChange},model:{value:e.weatherVal,callback:function(t){e.weatherVal=t},expression:"weatherVal"}},e._l(e.weatherOpts,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-button",{staticClass:"close-btn",attrs:{size:"mini"},on:{click:e.weatherClose}},[e._v("关闭")])],1)])},j=[];class E{constructor(e,t){if(!e)throw new Error("no viewer object!");t=t||{},this.tiltAngle=Cesium.defaultValue(t.tiltAngle,-.6),this.rainSize=Cesium.defaultValue(t.rainSize,.1),this.rainSpeed=Cesium.defaultValue(t.rainSpeed,1e3),this.viewer=e,this.init()}init(){this.rainStage=new Cesium.PostProcessStage({name:"czml_rain",fragmentShader:this.rain(),uniforms:{tiltAngle:()=>this.tiltAngle,rainSize:()=>this.rainSize,rainSpeed:()=>this.rainSpeed}}),this.viewer.scene.postProcessStages.add(this.rainStage)}destroy(){this.viewer&&this.rainStage&&(this.viewer.scene.postProcessStages.remove(this.rainStage),this.rainStage.destroy(),delete this.tiltAngle,delete this.rainSize,delete this.rainSpeed)}show(e){this.rainStage.enabled=e}rain(){return"#version 300 es\n    precision mediump float;\n\n    uniform sampler2D colorTexture;\n    in vec2 v_textureCoordinates;\n    uniform float tiltAngle;\n    uniform float rainSize;\n    uniform float rainSpeed;\n\n    float hash(float x) {\n        return fract(sin(x * 133.3) * 13.13);\n    }\n\n    out vec4 fragColor; // 输出颜色\n\n    void main(void) {\n        float time = czm_frameNumber / rainSpeed;\n        vec2 resolution = czm_viewport.zw;\n        vec2 uv = (gl_FragCoord.xy * 2. - resolution.xy) / min(resolution.x, resolution.y);\n        vec3 c = vec3(.6, .7, .8);\n        float a = tiltAngle;\n        float si = sin(a), co = cos(a);\n        uv *= mat2(co, -si, si, co);\n        uv *= length(uv + vec2(0, 4.9)) * rainSize + 1.;\n        float v = 1. - sin(hash(floor(uv.x * 100.)) * 2.);\n        float b = clamp(abs(sin(20. * time * v + uv.y * (5. / (2. + v)))) - .95, 0., 1.) * 20.;\n        c *= v * b;\n        fragColor = mix(texture(colorTexture, v_textureCoordinates), vec4(c, 1), .5);\n    }\n    "}}var V=E;class B{constructor(e,t){if(!e)throw new Error("no viewer object!");t=t||{},this.snowSize=Cesium.defaultValue(t.snowSize,.02),this.snowSpeed=Cesium.defaultValue(t.snowSpeed,60),this.viewer=e,this.init()}init(){this.snowStage=new Cesium.PostProcessStage({name:"czml_snow",fragmentShader:this.snow(),uniforms:{snowSize:()=>this.snowSize,snowSpeed:()=>this.snowSpeed}}),this.viewer.scene.postProcessStages.add(this.snowStage)}destroy(){this.viewer&&this.snowStage&&(this.viewer.scene.postProcessStages.remove(this.snowStage),this.snowStage.destroy(),delete this.snowSize,delete this.snowSpeed)}show(e){this.snowStage.enabled=e}snow(){return"#version 300 es\n    precision mediump float;\n\n    uniform sampler2D colorTexture;\n    in vec2 v_textureCoordinates;\n    uniform float snowSpeed;\n    uniform float snowSize;\n\n    float snow(vec2 uv, float scale) {\n        float time = czm_frameNumber / snowSpeed;\n        float w = smoothstep(1., 0., -uv.y * (scale / 10.));\n        if (w < .1) return 0.;\n        uv += time / scale;\n        uv.y += time * 2. / scale;\n        uv.x += sin(uv.y + time * .5) / scale;\n        uv *= scale;\n        vec2 s = floor(uv), f = fract(uv), p;\n        float k = 3., d;\n        p = .5 + .35 * sin(11. * fract(sin((s + p + scale) * mat2(7, 3, 6, 5)) * 5.)) - f;\n        d = length(p);\n        k = min(d, k);\n        k = smoothstep(0., k, sin(f.x + f.y) * snowSize);\n        return k * w;\n    }\n\n    out vec4 fragColor; // 输出颜色\n\n    void main(void) {\n        vec2 resolution = czm_viewport.zw;\n        vec2 uv = (gl_FragCoord.xy * 2. - resolution.xy) / min(resolution.x, resolution.y);\n        vec3 finalColor = vec3(0.);\n        float c = 0.;\n        c += snow(uv, 30.) * 0.;\n        c += snow(uv, 20.) * 0.;\n        c += snow(uv, 15.) * 0.;\n        c += snow(uv, 10.);\n        c += snow(uv, 8.);\n        c += snow(uv, 6.);\n        c += snow(uv, 5.);\n        finalColor = (vec3(c));\n        fragColor = mix(texture(colorTexture, v_textureCoordinates), vec4(finalColor, 1), .5);\n    }\n    "}}var $=B;class N{constructor(e,t){if(!e)throw new Error("no viewer object!");t=t||{},this.visibility=Cesium.defaultValue(t.visibility,.1),this.color=Cesium.defaultValue(t.color,new Cesium.Color(.8,.8,.8,.5)),this._show=Cesium.defaultValue(t.show,!0),this.viewer=e,this.init()}init(){this.fogStage=new Cesium.PostProcessStage({name:"czml_fog",fragmentShader:this.fog(),uniforms:{visibility:()=>this.visibility,fogColor:()=>this.color}}),this.viewer.scene.postProcessStages.add(this.fogStage)}destroy(){this.viewer&&this.fogStage&&(this.viewer.scene.postProcessStages.remove(this.fogStage),this.fogStage.destroy(),delete this.visibility,delete this.color)}show(e){this._show=e,this.fogStage.enabled=this._show}fog(){return"#version 300 es\n    precision mediump float;\n\n    uniform sampler2D colorTexture;\n    uniform sampler2D depthTexture;\n    uniform float visibility;\n    uniform vec4 fogColor;\n    in vec2 v_textureCoordinates;\n    out vec4 fragColor; // 输出颜色\n\n    void main(void) {\n        vec4 origcolor = texture(colorTexture, v_textureCoordinates);\n        float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n        vec4 depthcolor = texture(depthTexture, v_textureCoordinates);\n        float f = visibility * (depthcolor.r - 0.3) / 0.2;\n        if (f < 0.0) f = 0.0;\n        else if (f > 1.0) f = 1.0;\n        fragColor = mix(origcolor, fogColor, f);\n    }\n    "}}var J=N;let F,Y,G;var U={data(){return{loading:!1,weatherTool:!0,weatherVal:"请选择天气",weatherOpts:[{value:"rain",label:"雨"},{value:"snow",label:"雪"},{value:"fog",label:"雾"}]}},async mounted(){Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIwMGQ2OTY0OS05OWNiLTRmZDctYTcwNi1lYTY1NTVhODBhNDYiLCJpZCI6MjM5MTExLCJpYXQiOjE3MjU0NTU0ODZ9.JbglzGJ8dBc1tbZbb9GTKEuRlxyE6mXZKIWJ7E_diW4",this.viewer=new Cesium.Viewer("cesiumContainer",{animation:!1,timeline:!1,fullscreenButton:!0,homeButton:!1,sceneModePicker:!1,baseLayerPicker:!1,geocoder:!1,navigationHelpButton:!1,infoBox:!1,selectionIndicator:!1,terrainProvider:new Cesium.EllipsoidTerrainProvider}),this.viewer._cesiumWidget._creditContainer.style.display="none",this.imageLayers=this.viewer.imageryLayers,this.scene=this.viewer.scene,this.scene.globe.depthTestAgainstTerrain=!0;const e=this.viewer.entities.add({name:"3D Model with Multiple Materials",position:Cesium.Cartesian3.fromDegrees(112.94572462738567,28.187290962027646,40),model:{uri:"3Dmodels/3dtest.gltf",scale:1,minimumPixelSize:128,maximumScale:2e4}});this.viewer.zoomTo(e),P.$on("changeBaseMap",this.changeMap),P.$on("toggle-terrain",this.toggleTerrain),P.$on("toggle-weather",this.toggleWeather),this.weatherChange("")},beforeDestroy(){P.$off("changeBaseMap",this.changeMap),P.$off("toggle-terrain",this.toggleTerrain),P.$off("toggle-weather",this.toggleWeather)},methods:{async toggleTerrain(e){e?(this.loading=!0,this.viewer.terrainProvider=await Cesium.createWorldTerrainAsync(),this.$message({message:"已切换到 3D 地形",type:"success"}),this.loading=!1):(this.loading=!0,this.viewer.terrainProvider=new Cesium.EllipsoidTerrainProvider,this.$message({message:"已切换到 2D 地形",type:"success"}),this.loading=!1)},changeMap(e){this.imageLayers.removeAll(),this.imageLayers.addImageryProvider(e)},toggleWeather(e){this.weatherTool=e},weatherChange(e){switch(e){case"rain":Y&&Y.show(!1),G&&G.show(!1),F||(F=new V(this.viewer,{tiltAngle:-.2,rainSize:.5,rainSpeed:380})),F.show(!0);break;case"snow":F&&F.show(!1),G&&G.show(!1),Y||(Y=new $(this.viewer,{snowSize:.02,snowSpeed:80})),Y.show(!0);break;case"fog":F&&F.show(!1),Y&&Y.show(!1),G||(G=new J(this.viewer,{visibility:.25,color:new Cesium.Color(.8,.8,.8,.3)})),G.show(!0);break}},weatherClose(){F&&F.show(!1),Y&&Y.show(!1),G&&G.show(!1)},getLocation(){let e=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas);e.setInputAction((function(e){let t=this.viewer.scene.pickPosition(e.position);if(Cesium.defined(t)){let e=Cesium.Cartographic.fromCartesian(t),i=Cesium.Math.toDegrees(e.longitude).toFixed(5),n=Cesium.Math.toDegrees(e.latitude).toFixed(5),r=e.height.toFixed(2);console.log(t,{lon:i,lat:n,height:r})}}),Cesium.ScreenSpaceEventType.LEFT_CLICK)}}},Z=U,X=(0,D.A)(Z,L,j,!1,null,"d4063b44",null),K=X.exports,R=function(){var e=this,t=e._self._c;return t("div")},H=[],Q={},q=Q,ee=(0,D.A)(q,R,H,!1,null,"64e6aa92",null),te=ee.exports,ie={components:{headerContainer:W,mainContainer:K,asideContainer:te}},ne=ie,re=(0,D.A)(ne,_,T,!1,null,"bf0f05f2",null),oe=re.exports,se={name:"App",components:{container:oe}},ae=se,le=(0,D.A)(ae,x,b,!1,null,null,null),ce=le.exports,ue=i(6178);y["default"].use(ue.Ay);const he=[],de=new ue.Ay({mode:"history",routes:he});var me=de;y["default"].use(C()),y["default"].use(p(),g(),v(),d(),u(),l(),s(),r()),y["default"].use(me),y["default"].config.productionTip=!1,new y["default"]({render:e=>e(ce),router:me}).$mount("#app")}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,i),o.exports}i.m=e,function(){var e=[];i.O=function(t,n,r,o){if(!n){var s=1/0;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],o=e[u][2];for(var a=!0,l=0;l<n.length;l++)(!1&o||s>=o)&&Object.keys(i.O).every((function(e){return i.O[e](n[l])}))?n.splice(l--,1):(a=!1,o<s&&(s=o));if(a){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,r,o]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,o,s=n[0],a=n[1],l=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(r in a)i.o(a,r)&&(i.m[r]=a[r]);if(l)var u=l(i)}for(t&&t(n);c<s.length;c++)o=s[c],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(u)},n=self["webpackChunkhomework"]=self["webpackChunkhomework"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=i.O(void 0,[504],(function(){return i(7596)}));n=i.O(n)})();
//# sourceMappingURL=app.1fe52df1.js.map